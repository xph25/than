-- =============================
-- æœåŠ¡
-- =============================
local Players = game:GetService("Players")
æœ¬åœ° RunService = æ¸¸æˆ:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

æœ¬åœ°ç©å®¶ = Players.LocalPlayer

-- =============================
-- çŠ¶æ€å˜æ•°
-- =============================
local AutoAttack = false
æœ¬åœ°æ”»å‡»è·ç¦» = 20
local AbilityLoop = false
local LavaRemoved = false

-- =============================
-- è§’è‰² / HRP
-- =============================
æœ¬åœ°å‡½æ•° getHRP()
    local char = player.Character or player.CharacterAdded:Wait()
    è¿”å› char:WaitForChild("HumanoidRootPart")
ç»“å°¾

-- =============================
-- é¬¼èˆ¹ Lava ç§»é™¤ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰
-- =============================
task.spawn(function()
    è™½ç„¶æ²¡æœ‰ç§»é™¤ç†”å²©
        local map = workspace:FindFirstChild("Map")
        local gsi = map and map:FindFirstChild("GhostShipInterior")
        local lava = gsi and gsi:FindFirstChild("LavaParts") and gsi.LavaParts:FindFirstChild("Lava")

        å¦‚æœæ˜¯ç†”å²©çš„è¯
            lava:Destroy()
            ç†”å²©ç§»é™¤ = true
            warn("ğŸ”¥ å¹½çµèˆ¹ç†”å²©å·²ç§»é™¤")
        ç»“å°¾
        task.wait(1)
    ç»“å°¾
ç»“å°¾ï¼‰

-- =============================
-- æ¸…æ—§ GUI
-- =============================
å¦‚æœ player.PlayerGui:FindFirstChild("AutoAttackGUI") åˆ™
    player.PlayerGui.AutoAttackGUI:Destroy()
ç»“å°¾

-- =============================
-- å›¾å½¢ç”¨æˆ·ç•Œé¢
-- =============================
local gui = Instance.new("ScreenGui")
gui.Name = "è‡ªåŠ¨æ”»å‡»GUI"
gui.ResetOnSpawn = false
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.Parent = player.PlayerGui

local main = Instance.new("Frame")
main.Size = UDim2.new(0,280,0,300)
main.Position = UDim2.new(0.5,-140,0.5,-150)
main.BackgroundColor3 = Color3.fromRGB(30,30,30)
main.BorderSizePixel = 0
main.ZIndex = 2
main.Parent = gui

-- =============================
-- æ‹–æ›³ï¼ˆå–ä»£Draggableï¼‰
-- =============================
åš
    æœ¬åœ°æ‹–åŠ¨ã€æ‹–åŠ¨å¼€å§‹ã€èµ·å§‹ä½ç½®

    main.InputBegan:Connect(function(input)
        å¦‚æœ input.UserInputType == Enum.UserInputType.MouseButton1 é‚£ä¹ˆ
            æ‹–æ‹½ = çœŸ
            dragStart = input.Position
            startPos = main.Position
        ç»“å°¾
    ç»“å°¾ï¼‰

    UserInputService.InputChanged:Connect(function(input)
        å¦‚æœæ­£åœ¨æ‹–åŠ¨ä¸” input.UserInputType == Enum.UserInputType.MouseMovement åˆ™
            local delta = input.Position - dragStart
            main.Position = UDim2.new(
                startPos.X.Scaleï¼Œ
                startPos.X.Offset + delta.X,
                startPos.Y.Scaleï¼Œ
                startPos.Y.Offset + delta.Y
            ï¼‰
        ç»“å°¾
    ç»“å°¾ï¼‰

    UserInputService.InputEnded:Connect(function(input)
        å¦‚æœ input.UserInputType == Enum.UserInputType.MouseButton1 é‚£ä¹ˆ
            æ‹–æ‹½ = false
        ç»“å°¾
    ç»“å°¾ï¼‰
ç»“å°¾

-- =============================
-- æ ‡é¢˜åˆ—
-- =============================
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,30)
title.BackgroundColor3 = Color3.fromRGB(45,45,45)
title.Text = "å¹½çµèˆ¹æ¢çº½"
title.TextColor3 = Color3.new(1,1,1)
æ ‡é¢˜.æ–‡æœ¬å¤§å° = 18
title.ZIndex = 3
æ ‡é¢˜.çˆ¶çº§ = ä¸»

-- å…³é—­
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0,30,0,30)
closeBtn.Position = UDim2.new(1,-30,0,0)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.fromRGB(255,80,80)
closeBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
closeBtn.ZIndex = 4
å…³é—­æŒ‰é’®çš„çˆ¶çº§ = ä¸»çº§
closeBtn.MouseButton1Click:Connect(function()
    gui:Destroy()
ç»“å°¾ï¼‰

-- æœ€å°åŒ–
local miniBtn = Instance.new("TextButton")
miniBtn.Size = UDim2.new(0,30,0,30)
miniBtn.Position = UDim2.new(1,-60,0,0)
miniBtn.Text = "-"
miniBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
miniBtn.TextColor3 = Color3.new(1,1,1)
miniBtn.ZIndex = 4
miniBtn.Parent = main

æœ¬åœ°å†…å®¹ = Instance.new("Frame")
content.Size = UDim2.new(1,-20,1,-40)
content.Position = UDim2.new(0,10,0,35)
content.BackgroundTransparency = 1
content.Parent = main

å±€éƒ¨æœ€å°åŒ– = false
miniBtn.MouseButton1Click:Connect(function()
    æœ€å°åŒ– = æœªæœ€å°åŒ–
    å†…å®¹å¯è§ = æœªæœ€å°åŒ–
    miniBtn.Text = æœ€å°åŒ–ä¸”â€œ+â€æˆ–â€œ-â€
    main.Size = minimized ä¸” UDim2.new(0,280,0,30) æˆ– UDim2.new(0,280,0,300)
ç»“å°¾ï¼‰

-- =============================
-- è‡ªåŠ¨æ”»å‡»
-- =============================
local attackBtn = Instance.new("TextButton")
attackBtn.Size = UDim2.new(1,0,0,32)
AttackBtn.Text = "è‡ªåŠ¨æ”»å‡»ï¼šå…³é—­"
attackBtn.BackgroundColor3 = Color3.fromRGB(70,70,70)
attackBtn.TextColor3 = Color3.new(1,1,1)
attackBtn.Parent = å†…å®¹

attackBtn.MouseButton1Click:Connect(function()
    è‡ªåŠ¨æ”»å‡» = éè‡ªåŠ¨æ”»å‡»
    AttackBtn.Text = AutoAttack and "è‡ªåŠ¨æ”»å‡»ï¼šå¼€å¯" æˆ– "è‡ªåŠ¨æ”»å‡»ï¼šå…³é—­"
ç»“å°¾ï¼‰

-- =============================
-- v3 èƒ½åŠ›ï¼ˆå•ä¸€å¾ªç¯ï¼‰
-- =============================
local v3Btn = Instance.new("TextButton")
v3Btn.Size = UDim2.new(1,0,0,32)
v3Btn.Position = UDim2.new(0,0,0,40)
v3Btn.Text = "v3èƒ½åŠ›ï¼šå…³é—­"
v3Btn.BackgroundColor3 = Color3.fromRGB(90,60,120)
v3Btn.TextColor3 = Color3.new(1,1,1)
v3Btn.Parent = å†…å®¹

task.spawn(function()
    è™½ç„¶ç¡®å®å¦‚æ­¤
        å¦‚æœ AbilityLoop åˆ™
            pcall(function()
                ReplicatedStorage.Remotes.CommE:FireServer("ActivateAbility")
            ç»“å°¾ï¼‰
        ç»“å°¾
        task.wait(0.15)
    ç»“å°¾
ç»“å°¾ï¼‰

v3Btn.MouseButton1Click:Connect(function()
    AbilityLoop = é AbilityLoop
    v3Btn.Text=AbilityLoop and "v3èƒ½åŠ›ï¼šå¼€å¯" æˆ– "v3èƒ½åŠ›ï¼šå…³é—­"
ç»“å°¾ï¼‰

-- =============================
â€”â€”ä¼ é€
-- =============================
å±€éƒ¨å‡½æ•° tp(pos)
    local hrp = getHRP()
    hrp.CFrame = CFrame.new(pos)
ç»“å°¾

local ghostBtn = Instance.new("TextButton")
ghostBtn.Size = UDim2.new(1,0,0,32)
ghostBtn.Position = UDim2.new(0,0,0,80)
GhostBtn.Text = "ä¼ é€ï¼šã‚†ã†ã‚Œã„"
ghostBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
ghostBtn.TextColor3 = Color3.new(1,1,1)
ghostBtn.Parent = å†…å®¹
ghostBtn.MouseButton1Click:Connect(function()
    tp(Vector3.new(938,249,32888))
ç»“å°¾ï¼‰

local beanBtn = Instance.new("TextButton")
beanBtn.Size = UDim2.new(1,0,0,32)
beanBtn.Position = UDim2.new(0,0,0,120)
beanBtn.Text = "ä¼ é€ï¼šã¾ã‚ã¤ã¶ãã¿"
beanBtn.BackgroundColor3 = Color3.fromRGB(255,50,0)
beanBtn.TextColor3 = Color3.new(1,1,1)
beanBtn.Parent = å†…å®¹
beanBtn.MouseButton1Click:Connect(function()
    tp(Vector3.new(2284,15,911))
ç»“å°¾ï¼‰

-- =============================
-- è‡ªåŠ¨æ”»å‡»ä¸»å¾ªç¯ï¼ˆæ¨¡æ¿ï¼‰
-- =============================
task.spawn(function()
    while task.wait(0.25) do
        å¦‚æœå¯ç”¨è‡ªåŠ¨æ”»å‡»
            -- è¿™é‡Œå¯æ¥ä½ å…·ä½“çš„å‡»æ‰“/æˆ˜æ–—è¿œç¨‹
            --ç›®å‰åªä¿æŒç¨³å®šå¾ªç¯
        ç»“å°¾
    ç»“å°¾
ç»“å°¾ï¼‰
